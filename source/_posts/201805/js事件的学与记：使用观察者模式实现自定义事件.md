---
title: js事件的学与记：使用观察者模式实现自定义事件
date: 2018-05-08 10:55:09
updated: 2018-05-08 16:42:46
tags: [js事件, js面试题]
categories:
  - [JavaScript, js事件的学与记]
  - [面试题, js面试题的学与记]
copyright: '(c) 2018-present, WenKang Lin'
---

观察者模式（发布-订阅者模式），应该不用多说，使用场景应该说是无处不在的。如 `addEventListener`，又如 Node.js 中的 `EventEmitter`，还有 Vue 中数据更新驱动视图更新的原理，都是基于这个模式去实现的。

那么，自己通过观察者模式怎么去实现呢？这也是在经历面试过程中，经常会被面试官问到的。

<!-- more -->

自定义事件的功能，一般也要包括以下几个功能：

* 事件订阅功能 on。
* 事件发布功能 emit。
* 事件取消订阅功能 off。
* 事件单次订阅功能 once。

{% jsfiddle 1zsqd2tt js dark %}

上面示例的代码，原理很简单。用一个对象 `storage` 存储当下所有的事件名称和事件监听器。每一种事件类型，都将作为这个对象的 key 值，即属性名，属性值是数组，存储每一个事件类型下的所有事件。
